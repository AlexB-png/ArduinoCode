#include <LiquidCrystal_I2C.h>

#include <Keypad.h>

const byte ROWS = 4;
const byte COLS = 4;

String input = "";

LiquidCrystal_I2C lcd(0x27, 16, 2);

// Define the keymap
char keys[ROWS][COLS] = {
  {'1','2','3','A'},
  {'4','5','6','B'},
  {'7','8','9','C'},
  {'*','0','#','D'}
};

// Connect keypad ROW0, ROW1, ROW2, ROW3 to these Arduino pins
byte rowPins[ROWS] = {9, 8, 7, 6};

// Connect keypad COL0, COL1, COL2, COL3 to these Arduino pins
byte colPins[COLS] = {5, 4, 3, 2};

// Create the keypad object
Keypad keypad = Keypad(makeKeymap(keys), rowPins, colPins, ROWS, COLS);

void setup() {
  Serial.begin(9600);
  Serial.println("4x4 Keypad Test");

  // Turn on the LED backlight for the LCD
  lcd.init();
  lcd.backlight();
}

void loop() {
  char key = keypad.getKey();

  // If key has been pressed
  if (key) {
    Serial.print("Key Pressed: ");
    Serial.println(key);

    // Add key to input string
    input += key;

    // Reset inputs when * button pressed
    if (key == '*') {
      input = "";
      lcd.setCursor(0, 0);
      lcd.print("                ");
    } else if (input.length() < 17) { // If the screen line is NOT full
      lcd.setCursor(0, 0);
      lcd.print(input);
    } else { // If the screen line is full
      lcd.setCursor(0, 0);
      lcd.print("Code too long!  ");
    }
  }
}
